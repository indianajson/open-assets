<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Drops (script)</title>
    <link rel="stylesheet" href="../github-markdown-light.css" id="theme-stylesheet">
    <!-- Feather Icons -->
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        body { 
            padding:20px;
            text-align: justify;
        }
        #content{
            max-width: 800px;
            margin:auto;
        }
        .theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        background: var(--toggle-bg, #f6f8fa);
        border: 1px solid var(--toggle-border, #d0d7de);
        border-radius: 50%;
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .theme-toggle svg {
            width: 24px;
            height: 24px;
            stroke: var(--icon-color, #57606a);
        }

        /* Dark mode variables - Make sure these are defined */
        body.dark-mode {
            --bg-color: #0d1117;
            --text-color: #c9d1d9;
            --toggle-bg: #21262d;
            --toggle-border: #30363d;
            --icon-color: #8b949e;
        }

        /* Explicit dark mode styles for theme toggle */
        body.dark-mode .theme-toggle {
            background: #21262d;
            border-color: #30363d;
        }

        body.dark-mode .theme-toggle svg {
            stroke: #8b949e;
        }
        .download-btn {
            position: fixed;
            top: 20px;
            right: 80px; /* Position to the left of the theme toggle */
            z-index: 1000;
            background: var(--toggle-bg, #f6f8fa);
            border: 1px solid var(--toggle-border, #d0d7de);
            border-radius: 25px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            text-decoration: none;
            color: var(--icon-color, #57606a);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 14px;
            font-weight: 500;
        }

        .download-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            text-decoration: none;
            color: var(--icon-color, #57606a);
        }

        .download-btn svg {
            width: 18px;
            height: 18px;
            stroke: var(--icon-color, #57606a);
        }

        /* Dark mode styles for download button */
        body.dark-mode .download-btn {
            background: var(--toggle-bg, #21262d);
            border-color: var(--toggle-border, #30363d);
            color: var(--icon-color, #8b949e);
        }

        body.dark-mode .download-btn svg {
            stroke: var(--icon-color, #8b949e);
        }

  </style>
</head>
<body class="markdown-body">
    <a href="simple-drops.zip" class="download-btn" id="downloadBtn" download>
    <i data-feather="download"></i>
    <span>Download</span>
    </a>
    <div class="theme-toggle" id="themeToggle">
        <i data-feather="moon"></i>
    </div>
    <br>
  <div id="content"></div>
  <script src="https://cdn.jsdelivr.net/npm/marked/lib/marked.umd.js"></script>
  <script>
    document.getElementById('content').innerHTML =
      marked.parse(`
      
# Simple Drops
A script to add easily configurable ice tile drops in Open Net Battle servers. 

### How does it work?

> This script is plug-n-play. Once you copy the required scripts to your server (see below) everything else is configured within the Tiled map editor for your server area. You simply add an object to your map with the required parameters and the script does the rest. Currently, this script supports ice drops (sliding off the edge of ice tiles), but down the road it will hopefully include normal drop zones as well. 

### Want to try it out?

> This repository contains a complete test server you can spin up that includes configured examples in all four directions. It will show you how they should be configured and how they function in-game without having to do the setup yourself.

### How do I install this on my ONB server?

> 1. Download the repository.
> 2. Copy \`/scripts/simple-drops/\` to your server's script folder.

### How do I add an Ice Drop?
> 1. Open your map in Tiled.
> 2. Select an Object Layer on your map.
> 3. Insert a Point (you can press \`I\` on your keyboard then click to place it).
> 4. Position the Point near the middle of the tile you want to become a drop zone.
> 5. Set the Class to \`Ice Drop\`
> 6. Add two string based Custom Properties<br>
> &nbsp; &nbsp; \`Drop Edge\` determines which side is a drop off ("Down Left", "Down Right", "Up Left", "Up Right")<br>
> &nbsp; &nbsp; \`Landing\` should be a whole number representing the Z or layer where the player is supposed to land.<br>
> If you want two edges to be drop zones simply set a second Point with the \`Drop Edge\` as the other edge.

On boot your server log should show the ice drop was added at that location, or an error if it was improperly configured. 

I highly recommend my [Fix Layers](../fix-layers/) Tiled extension as it makes adding new layers a breeze. 

### Doesn't ezwarps from ezlibs do this already?

> The \`fall_off_2\` animation provided with ezwarps does provide a similar function, however, it is limited to two layer drops only and may not work properly for "Up Left" and "Up Right" drops. 
      
      `);
  </script>
  <script>
    //Script to handle Light/Dark Mode

        // Initialize Feather icons
        feather.replace();
        
        // Theme toggle functionality
        const themeToggle = document.getElementById('themeToggle');
        const themeStylesheet = document.getElementById('theme-stylesheet');
        
        // Check for saved theme preference or respect OS preference
        const savedTheme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        // Set initial theme
        if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
            document.body.classList.add('dark-mode');
            themeStylesheet.href = '../github-markdown-dark.css';
            themeToggle.innerHTML = feather.icons.sun.toSvg();
        }
        
        // Toggle theme function
        function toggleTheme() {
        const body = document.body;
        const themeToggle = document.getElementById('themeToggle');
        const downloadBtn = document.getElementById('downloadBtn');
        const themeStylesheet = document.getElementById('theme-stylesheet');
        
        if (body.classList.contains('dark-mode')) {
            // Switch to light mode
            body.classList.remove('dark-mode');
            themeStylesheet.href = '../github-markdown-light.css';
            themeToggle.innerHTML = feather.icons.moon.toSvg();
        } else {
            // Switch to dark mode
            body.classList.add('dark-mode');
            themeStylesheet.href = '../github-markdown-dark.css';
            themeToggle.innerHTML = feather.icons.sun.toSvg();
        }
        
        // Save preference to localStorage
        localStorage.setItem('theme', body.classList.contains('dark-mode') ? 'dark' : 'light');
        
        // Update Feather icons
        feather.replace();
        }
        
        // Add click event to toggle button
        themeToggle.addEventListener('click', toggleTheme);
    </script>
</body>
</html>
