<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indy's Layer Fixer</title>
    <link rel="stylesheet" href="github-markdown-light.css" id="theme-stylesheet">
    <!-- Feather Icons -->
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        body { 
            padding:20px;
            text-align: justify;
        }
        #content{
            max-width: 800px;
            margin:auto;
        }
        .theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
        background: var(--toggle-bg, #f6f8fa);
        border: 1px solid var(--toggle-border, #d0d7de);
        border-radius: 50%;
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .theme-toggle svg {
            width: 24px;
            height: 24px;
            stroke: var(--icon-color, #57606a);
        }

        /* Dark mode variables - Make sure these are defined */
        body.dark-mode {
            --bg-color: #0d1117;
            --text-color: #c9d1d9;
            --toggle-bg: #21262d;
            --toggle-border: #30363d;
            --icon-color: #8b949e;
        }

        /* Explicit dark mode styles for theme toggle */
        body.dark-mode .theme-toggle {
            background: #21262d;
            border-color: #30363d;
        }

        body.dark-mode .theme-toggle svg {
            stroke: #8b949e;
        }
        .download-btn {
            position: fixed;
            top: 20px;
            right: 80px; /* Position to the left of the theme toggle */
            z-index: 1000;
            background: var(--toggle-bg, #f6f8fa);
            border: 1px solid var(--toggle-border, #d0d7de);
            border-radius: 25px;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            text-decoration: none;
            color: var(--icon-color, #57606a);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 14px;
            font-weight: 500;
        }

        .download-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            text-decoration: none;
            color: var(--icon-color, #57606a);
        }

        .download-btn svg {
            width: 18px;
            height: 18px;
            stroke: var(--icon-color, #57606a);
        }

        /* Dark mode styles for download button */
        body.dark-mode .download-btn {
            background: var(--toggle-bg, #21262d);
            border-color: var(--toggle-border, #30363d);
            color: var(--icon-color, #8b949e);
        }

        body.dark-mode .download-btn svg {
            stroke: var(--icon-color, #8b949e);
        }

  </style>
</head>
<body class="markdown-body">
    <a href="indys-layer-fixer.js" class="download-btn" id="downloadBtn" download>
    <i data-feather="download"></i>
    <span>Download</span>
    </a>
    <div class="theme-toggle" id="themeToggle">
        <i data-feather="moon"></i>
    </div>
    <br>
  <div id="content"></div>
  <script src="https://cdn.jsdelivr.net/npm/marked/lib/marked.umd.js"></script>
  <script>
    document.getElementById('content').innerHTML =
      marked.parse(`
      
# Indy's Layer Fixer
A Tiled 1.8+ extension to automatically fix layers and vertical offsets on ONB maps!
<br>

## What does it do?

Have you ever realized you need to add an extra floor into your ONB map and didn't want to go through the hassle of fixing all the layer names and vertical offsets? Yep, me too. It's a pain. This plugin fixes that in one click. 

<img src="fix.png" height=300 />

All you need to do is (1) add your extra Tile and Object layers to your map, (2) position them correctly in the Layers menu on the right, and (3) run "Fix Layers for ONB" (under the Edit menu) and the layers will all be renamed and the offsets fixed per the order in the Layers menu.

<img src="menu.jpg" height=300 />

## How do I install this?

1. Make sure you have Tiled 1.8 **or newer**.
2. Open Tiled and go to Settings... ( _Ctrl + ,_ )
3. Go to the Plugins tab and click "Open..." near the bottom.
4. Copy \`indys-layer-fixer.js\` into the folder that opens.

Under the Edit menu you will see a new option at the bottom named "Fix Layers for ONB". You can also use Ctrl+P to run the command.
      
      `);
  </script>
  <script>
    //Script to handle Light/Dark Mode

        // Initialize Feather icons
        feather.replace();
        
        // Theme toggle functionality
        const themeToggle = document.getElementById('themeToggle');
        const themeStylesheet = document.getElementById('theme-stylesheet');
        
        // Check for saved theme preference or respect OS preference
        const savedTheme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        // Set initial theme
        if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
            document.body.classList.add('dark-mode');
            themeStylesheet.href = 'github-markdown-dark.css';
            themeToggle.innerHTML = feather.icons.sun.toSvg();
        }
        
        // Toggle theme function
        function toggleTheme() {
        const body = document.body;
        const themeToggle = document.getElementById('themeToggle');
        const downloadBtn = document.getElementById('downloadBtn');
        const themeStylesheet = document.getElementById('theme-stylesheet');
        
        if (body.classList.contains('dark-mode')) {
            // Switch to light mode
            body.classList.remove('dark-mode');
            themeStylesheet.href = 'github-markdown-light.css';
            themeToggle.innerHTML = feather.icons.moon.toSvg();
        } else {
            // Switch to dark mode
            body.classList.add('dark-mode');
            themeStylesheet.href = 'github-markdown-dark.css';
            themeToggle.innerHTML = feather.icons.sun.toSvg();
        }
        
        // Save preference to localStorage
        localStorage.setItem('theme', body.classList.contains('dark-mode') ? 'dark' : 'light');
        
        // Update Feather icons
        feather.replace();
        }
        
        // Add click event to toggle button
        themeToggle.addEventListener('click', toggleTheme);
    </script>
</body>
</html>
